\section{Theoretical Background}
\subsection{The macroscopic description}\label{Macroscopic}
The motion of fluids may be described macroscopically using the Navier--Stokes equation.\cite{simpleLiquids} 
This models liquids as a continuous medium and combines the conservation of mass and momentum with the relation between the force on a volume element and the local fluid flow.
In the low Reynolds-number regime the flow velocity is small, and the Navier--Stokes equation reduces to
\begin{equation}
\label{NavierStokes}
\eta \nabla^{2}\mathbf{v}(r,t) = \nabla P(r,t) - \mathbf{f}(r).
\end{equation}
Equation \ref{NavierStokes} shows that motion in fluids \textit{can only} occur through a pressure gradient or external forces.
In Marangoni flows, motion from a temperature gradient must result from induced local pressure gradients, which may be derived from thermodynamics.

Consider a binary--mixture with an interface at $z=0$.
The Gibbs--Duhem equation gives
\begin{equation}
V \mathrm{d}P = \sum_{i=0}^{n} N_{i} \mathrm{d}\mu_{i} + S \mathrm{d}T.
\end{equation}
The bulk fluid pressure is constant and isotropic, giving
\begin{equation}
\label{GibbsDuhem}
\left( \frac{\partial P}{\partial x}\right) = \sum_{i=0}^{n} \rho_{i}^{\mathrm{B}} \left(\frac{\partial \mu_{i}}{\partial x}\right) + \frac{S}{V} \left( \frac{\partial T}{\partial x}\right) = 0.
\end{equation}
The Maxwell relations relate the entropy to the partial differential of chemical potential with respect to temperature through
\begin{equation}
\left( \frac{\partial\mu_{i}}{\partial T} \right)_{P,N_{i}} = - \left(\frac{\partial S}{\partial N_{i}}\right)_{P,T}.
\end{equation}
The total entropy is the weighted sum of the partial entropy of each species in the system, 
\begin{equation}
S = \sum_{i=0}^{n}s_{i}N_{i},
\end{equation}
thus
\begin{equation}
\left( \frac{\partial\mu_{i}}{\partial T} \right)_{P,N_{i}} = - s_{i}.
\end{equation}
\\
This allows Equation \ref{GibbsDuhem} to be expressed as
\begin{equation}
\left( - \sum_{i=1}^{n}\rho_{i}^{\mathrm{B}}s_{i}^{\mathrm{B}}+\frac{S^{\mathrm{B}}}{V}\right)\left(\frac{\partial T}{\partial x}\right) = 0,
\end{equation}
for which the solution is 
\begin{equation}
\frac{S^{\mathrm{B}}}{V} = \sum_{i=1}^{n}\rho_{i}^{\mathrm{B}}s_{i}^{\mathrm{B}}.
\end{equation}
\\
Consider the case close to an interface where the pressure will deviate from its bulk value.
Since $\mu_{i}$ and T are independent of $z$,
\begin{equation}
\left(\frac{\partial \mu_{i}}{\partial T}\right) = - s_{i}^{\mathrm{B}},
\end{equation}
and the pressure gradient reduces to
\begin{equation}
\left(\frac{\partial P(z,x)}{\partial x}\right) = \left(\sum_{i=1}^{n}\rho_{i}(z)\left(s_{i}(z)-s_{i}^{\mathrm{B}}\right)\right)\left(\frac{\partial T}{\partial x}\right).
\label{PressGrad}
\end{equation}

For an ideal mixture, the partial entropy is given by $s_{i}=\frac{1}{T} \left(\mu_{i}-h_{i} \right)$, and Equation \ref{PressGrad} can be expressed in terms of the excess enthalpy density, $\Delta h(z)$,
\begin{equation}
\label{ExcessEnthalpy}
\left(\frac{\partial P(z,x)}{\partial x}\right)= - \Delta h(z)\frac{1}{T} \left( \frac{\partial T}{\partial x} \right) 
= - \Delta h(z) \left( \frac{\partial \ln T}{\partial x} \right).
\end{equation}

Substituting Equation \ref{ExcessEnthalpy} into Equation \ref{NavierStokes} and assuming a constant pressure in the $(z,y)$ directions allows the velocity, $v_{x}(z)$, at the interface to be computed as
\begin{equation}
\label{DoubleIntegral}
v_{x} (z=0) = - \frac{1}{\eta}\int_{0}^{\infty} \mathrm{d}z\, z \Delta h(z) \frac{\partial T}{\partial x}
\end{equation}
where it has been assumed that the bulk fluid is at rest ($v_{x}(z=\infty)=0$).
This expression is almost equivalent to that derived by Derjaguin et al., except for a factor of two, suggesting a potential error in Derjaguin's approach.\cite{SurfaceForces, Anderson}

\subsection{A microscopic approach}
The Marangoni effect occurs on microscopic length--scales, and hence a macroscopic approach is not entirely appropriate.
Instead of solving the Navier--Stokes equation, the velocity should be related directly to the local forces acting on the fluid, which may be calculated from the local stress tensor,
\begin{equation}
\label{ForceStress}
f_{x}(z) = - \left( \frac{\partial \sigma_{xx}(z,x)}{\partial x} \right).
\end{equation}

The Marangoni force occurs due to temperature gradients and $f_{x}(z)$ can be calculated through the chain rule as
\begin{equation}
\label{ForceStressTemp}
f_{x}(z) = - \left( \frac{\partial \sigma_{xx}(z,x)}{\partial T} \right) \left( \frac{\partial T}{\partial x} \right).
\end{equation}

\subsection{The finite difference approach}
Equation \ref{ForceStressTemp} demonstrates that the Marangoni force can be inferred from the temperature dependence of the stress tensor. 
To a first order approximation, the temperature gradient of the stress tensor can be estimated from a finite difference as
\begin{equation}
\label{FinDiff}
\left( \frac{\partial \sigma_{xx}(z,x)}{\partial T} \right) \approx \frac{\sigma_{xx}^{T_{2}}(z,x) - \sigma_{xx}^{T_{1}}(z,x)}{T_{2} - T_{1}}.
\end{equation}
Using this approximation, the Marangoni flow profile can be computed as follows:
\begin{enumerate}
	\item Compute $\sigma_{xx}(z)$ for an equilibrium system at temperature $T_{1}$.
	\item Repeat the calculation for another equilibrium system at a slightly higher temperate $T_{2}$.
	\item Approximate the partial derivative of the transverse stress with respect to temperature using the finite difference, Equation \ref{FinDiff}.
	\item Infer $f_{x}(z)$ for a specified value of $\partial T / \partial x$ using Equation \ref{ForceStressTemp}.
	\item Compute the flow profile by applying $f_{x}(z)$ as a body force in an equilibrium simulation at an intermediate temperature $T_{3}$ (where $T_{1} < T_{3} < T_{2}$).
\end{enumerate}

\subsection{Non-uniqueness of the pressure tensor}
The stress tensor is related to the pressure tensor through
\begin{equation}
\sigma_{\alpha \beta}(\mathbf{r}) = - P_{\alpha \beta} (\mathbf{r}).
\end{equation}
The pressure tensor is composed of a kinetic contribution, arising from the momentum transfer of particles on the container walls, and a potential contribution attributed to the interparticle forces.\cite{VarnikBinder}
The kinetic part is calculated from the ideal gas contribution,
\begin{equation}
\mathbf{P}^{K}(\mathbf{r})=k_{\mathrm{B}} T \rho(\mathbf{r}) \hat{\mathbf{I}},
\end{equation}
whilst the potential contribution cannot be uniquely defined.

For a homogeneous fluid the stress tensor is isotropic, with each diagonal element equal to $- P$, where $P$ is the bulk hydrostatic pressure. 
This pressure can be calculated using the virial equation, originally derived from Clausius' virial theorem\cite{Clausius} (also derivable by differentiating the canonical partition function\cite{MolTheoryCap}), to give
\begin{equation}
\label{VirialPressure}
P_{\alpha \beta}(\mathbf{r})=\frac{1}{V} \left( -m(\mathbf{r})\left< \nu_{\alpha} \nu_{\beta} \right> + \frac{1}{2} \sum_{i}^{N} \sum_{j \neq i}^{N} (r_{\alpha}^{(i)} - r_{\alpha}^{(j)})f_{\beta}^{ij} \right).
\end{equation}
Clausius' formulation calculates the local pressure by considering the forces acting on particles located within a volume element at $\mathbf{r}$.

In an inhomogeneous system there is an ambiguity over which particles should contribute to the force at a given position.\cite{MolTheoryCap,VarnikBinder,Rowlinson1982}
This was first discussed by Irving and Kirkwood\cite{IrvingKirkwood1949,IrvingKirkwood1950} who described an alternative method that computes the pressure tensor from the forces acting across an infinitesimal surface $\mathrm{d}\mathbf{A}$ located at $\mathbf{r}$.
They calculate the local pressure tensor using only pairs of particles for which the line connecting their centers of mass passes through $\mathrm{d}\mathbf{A}$.
For a planar system with an interface in the $(x,y)$ plane, the pressure tensor depends only on the distance from this interface and the normal and tangential components are given by
\begin{align}
\label{IKpressureN}
P_{\mathrm{N}}^{\mathrm{IK}}(z) &= \rho(z)k_{\mathrm{B}}T-\frac{1}{2A} \left< \sum_{i \neq j} \frac{|z_{ij}|}{r_{ij}} U'(r_{ij}) \Theta \left( \frac{z-z_{i}}{z_{ij}}\right) \Theta \left( \frac{z_{j} - z}{z_{ij}} \right) \right>,\\
\label{IKpressureT}
P_{\mathrm{T}}^{\mathrm{IK}}(z) &= \rho(z)k_{\mathrm{B}}T-\frac{1}{4A} \left< \sum_{i \neq j} \frac{x^{2}_{ij} + y^{2}_{ij}}{r_{ij}} \frac{U'(r_{ij})}{|z_{ij}|} \Theta \left( \frac{z-z_{i}}{z_{ij}}\right) \Theta \left( \frac{z_{j} - z}{z_{ij}} \right) \right>,
\end{align}
where $\Theta \left(x \right)$ is the Heaviside step function.

For studying confined systems, the Irving--Kirkwood stress has many advantages.
In particular it yields a normal component independent of local fluctuations in the number density.
Density fluctuations occur close to walls due to structural layering of the fluid, and there is reduced density at liquid--liquid interfaces from the finite width of the interfacial region.
Consequently, the normal component of the virial pressure oscillates\cite{VarnikBinder} whilst the Irving--Kirkwood normal component is constant and equal to the bulk hydrostatic pressure.
This is more consistent with intuition since the fluid is isotropic in the direction normal to surfaces.
