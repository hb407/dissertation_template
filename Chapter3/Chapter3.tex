\section{Computational Methods}

Equilibrium MD simulations of a symmetric binary--mixture of two immiscible fluids (A and B) were used to measure the stresses acting on the fluid at two different temperatures and infer the Marangoni force using Eqn. \ref{FinDiff}.
Two key arrangements of such a mixture were studied, a symmetrical binaryâ€“mixture under three--dimensional periodic boundary conditions and a binary--mixture periodic in two--dimensions but held within two walls in the third-dimension, as shown in Fig. \ref{SetUp}.
All molecular dynamics simulations were executed using the LAMMPS (Large Atomic and Molecular Massively Parallel Simulator) package.\cite{LAMMPS}  

\begin{figure}[h]
        \includegraphics[scale=0.25]{AABB.png}
        \includegraphics[scale=0.25]{AABB_piston.png}
\caption{The system arrangements for a symmetric binary--mixture of two immiscible fluids under three-dimensional periodic boundary conditions (left) and a binary--mixture periodic in two--dimensions held within two walls (right) are shown. 
In the case of the three--dimensional boundary conditions, pressure must be controlled use a Nos\'{e}--Hoover barostat whilst for the fluid confined between two walls, these walls may be used as a piston to control the fluid pressure.}
\label{SetUp}
\end{figure}

\subsection{Interaction Model}\label{InteractionModel}
The fluids were modelled using spherical particles and their interaction was controlled using a pair--wuse truncated Lennard--Jones potential:
\begin{equation}
V \left( \mathbf{r}^{\mathrm{N}} \right) = \frac{1}{2} \sum_{i\neq j} \phi \left( r_{ij} \right)
\end{equation}
where
\begin{align}
\label{LJ}
\phi \left( r_{ij} \right) &= 4 \epsilon_{ij} \left( \left( \frac{\sigma_{ij}}{r_{ij}}\right)^{12} - \left( \frac{\sigma_{ij}}{r_{ij}}\right)^{6} \right)\ \mathrm{for}\ r < r_{c}\\
\phi \left( r_{ij} \right) &= 0\ \mathrm{otherwise}.
\end{align}
This potential involves an attractive $ri_{ij}^{-6}$ term accounting for the long--range Van der Waal's interaction and a short--range $r_{ij}^{-12}$ repulsion term corresponding to the Pauli repulsion between particles.
The length--scale of the potential is given by $\sigma_{ij}$, which was chosen to be equal for all $ij$, whilst the parameter $\epsilon_{ij}$ determines the strength of the interaction. 
It is often convenient to express quantities including distances and energies in terms of reduced units.
For a Lennard--Jones system the basic units chosen are $\sigma$ for length, $\epsilon$ for energy and $m$ for mass and all the units others may be derived from these.\cite{FrenkelSmit}
Physical quantities become dimensionless when expressed in terms of these reduced units, for example $r^{*} \equiv r / \sigma$.
In simulations were the box--dimensions may vary (for example when controlling the pressure) a scaled coordinate relative to the box size can be used, for example $z' = z^{*} / L_{z^{*}}$ where $L_{z^{*}}$ is the dimension of the box in the z--direction. 

The miscibility of the two fluids (A and B) can be controlled by adjusting the relative values of this interaction paramter, in this study the values chosen were:
\begin{align}
\epsilon_{A,A} &= \epsilon_{B,B} = 1.0,\\
\epsilon_{A,B} &= 0.55,
\end{align}
in agrement with previous studies on symmetrical Lennard--Jones binary mixtures.\cite{MorenzoRazo,Blas,HolgerBoppHampe}
The cutoff for the Lennard--Jones potential was chosen to be $r_{c}^{*} = 4$.

\subsection{Thermostats}
In molecular dynamics simulations the temperature can be controlled using thermostats which simulate coupling of the system to an external heat bath.

Thermostats work by applying a stochastic frictional force to particles, either by adding a random force to momenta (Langevin)\cite{Langevin} or reassinging the velocity of a randomly chosen particle from the Maxwell distribtuion (Anderson)\cite{AndersonTherm}.
Throughout this study, the Nos\'{e}--Hoover thermostat was used.
This method adds an extra term into the equations of motion to provide the effect of an external heat bath.\cite{NoseHoover1, NoseHoover2, NoseHoover3}
The result is a system where the energy fluctuates whilst the total energy of the system and heat bath remains constant, thus maintaining a canonical ensemble.

\subsection{Barostats}
The bulk pressure of the fluid must also be held constant for these simulations, since if this were not true then unphysical body forces could occur in the fluid bulk.
A piston is the simplest way to control the bulk pressure and is relatively easy to create; the fluid is confined between two solid walls and a force equal to $P_{ext} / A_{wall}$ is applied.
This is the method used for studing the binary--mixture confined between two planar walls.
In the case of Marangoni flows a potentially problematic thermocapillary effect will also occur at the boundary of the liquid and the solid piston.
Despite this, if the thermocapillary force can be ignored and non--slip wall boundary conditions exist then a piston also provides a method for fixing the bulk fluid at rest.

Alternatively a Nos\'{e}--Hoover barostat can control the pressure by altering the box dimensions and adjusting the equations of motion accordingly. \cite{NoseHoover1, NoseHoover2, NoseHoover3}
When studying the surface--driven effects the box dimensions must only be changed in the normal direction to the interface, since any other direction will alter the area of the interface and create an error in the thermodynamic pressure,
\begin{equation}
P = - \left( \frac{\partial F}{\partial V} \right)_{T} + \gamma \left( \frac{\partial A}{\partial V} \right)_{T}.
\end{equation}

\subsection{Preparing the system}
The fluid was prepared from a face--centred cubic lattice of spherical particles with a spacing of $1.64414\ \sigma$ and a periodic box dimension of $L_{x^{*}}=13.1531$, $L_{y^{*}}=13.1531$ and $L_{z^{*}}=32.8828$.
This lattice was equilibrated over $2\times 10^{6}$ timesteps of length $0.001\ \tau$ to generate a fluid state.
The barostat was set to a pressure of $P^{*} = 0.1$ and the temperatures used were $T^{*} = 0.8$ and $T^{*} = 0.8$, ensuring the system occupied the liguid region of the Lennard--Jones phase space.\cite{Smit}
Solid walls in the system were represented by a harmonically bonded lattice with spring constant of $K^{*} = 2500$ and an equilbrium length of $r^{*}_{0}=1.163$.

\subsection{Calculating the stress--tensor}\label{CalcStress}
The Virial stress--tensor was calculated using an in--built function within the LAMMPS package and outputted as a per--atom variable or spatially and temporally averaged during the simulation.
This may be performed for groups of atoms (for example the individual fluid atoms) or for the system as a whole.

LAMMPS does not have a mechanism for calculating the Irving--Kirkwood stress--tensor.
Instead this was calculated by dumping the particle positions on a given timestep to a file and post--processing.
The stress--tensor was then computed using a programme written by R. Ganti and adapted for the specific systems studied.
However this was significantly more expensive than the Virial stress--tensor, incurring approximately a 4-fold increase in computational time.

\subsection{Calculating averages}
Usually the time--averages of physical observables are calculated in molecular dynamics simulations. 
In the simulations studied these observables corresponded to the number--density, stress--tensor and particle velocity.
Their values were measured every timestep and spatially averaged for $400$ planar slabs across the z--dimension of the box.
These spatial averages were then time--averaged over the full duration of the simulation.

Under the ergodic hypothesis time--averages can be equated to ensemble averages for an infinitely long simulation time.\cite{Bopp2008}
Practically, however, these averages must be evaluated over a finite time period and have an associated statistical error.
The method of block--averaging developed by Flybjerg and Peterson provides an efficient technique for computing this error.\cite{Flyvbjerg1989}
They show that the variance of an observable, $A$, can be estimated by
\begin{equation}
\mathrm{var}(A) \geq \left< \frac{C_{0}}{n-1} \right>,
\end{equation}
where $C_{0}$ is the value of the time-correlation function for the blocked data at $t=0$ and is given by
\begin{equation}
C_{0} \equiv \frac{1}{n} \sum_{k=1}^{n}(A_{k} - \bar{A})(A_{k} - \bar{A}).
\end{equation}
A lower bound for the variance can be calculated by finding the block length at which this estimate reaches a plateau.
Furthermore the error in the variance can be estimated as 
\begin{equation}
\sqrt{\frac{2}{n-1} \times \frac{C_{0}}{n-1}}.
\end{equation}

\begin{figure*}
\hspace{-4em}
        \includegraphics[scale=0.35]{block_average_10e6.eps}
        \includegraphics[scale=0.35]{block_average_1e6.eps}
	\caption{The blocking analysis for a simulation time of 10,000,000 timesteps and 1,000,000 timesteps shows clear plateaus in the estimate of the error at block sizes of 10,000 and 5,000 respectively.
This can be used to estimate the size of blocking needed to decorrelate data in the correspinding molecular dynamics simulations.}
\label{blocking}
\end{figure*}

\FloatBarrier
A blocking--analysis for a binary--mixture identical to those used throughout this study was executed over a simulation time of $1,000\ \tau$ and $10,000\ \tau$, as shown in Figure \ref{blocking}.
The plateau occurs at a block length of $10\ \tau$ for the long simulation and $5\ \tau$ for the shorter run, with little increase in the error of the variance until a much larger block size.
Considering this result, a block length of $10\ \tau$ was used to provide a good estimate for the error of all time--averages calculated in the subsequent simulations described.

\subsection{Modelling surfactants}
\begin{figure*}[h]
\centering
\includegraphics[scale=0.4]{surfactant.png}
\caption{Surfactant molecule}
\label{surfactant}
\end{figure*}
\FloatBarrier
Surface--active molecules are characterised by head and tail groups which have differing interaction strengths with the component fluids of an immiscible mixture.
To investigate the effects of surfactants on the Marangoni effect, the surfactant molecules are modelled as a pair of Lennard--Jones particles connected by a harmonic bond with spring constant $K^{*} = 25$ and equilibrium bond length $r_{0}=1.63$.
Inspired by Howes and Radke's study on non--ionic surfactants,\cite{HowesSurfactant} the `head' particle has a stronger interaction with fluid A particles, ($\epsilon_{H, A} = 1.33$ and $\epsilon_{H, B} = 0.17$) whilst the `tail' particle has a stronger interaction with fluid B particles ($\epsilon_{T, A} = 0.17$ and $\epsilon_{T, B} = 1.33$).
The `head' and `tail' groups interact with each other through the interaction paramter $\epsilon_{H, T} = 1.00$.

\subsection{Software details}
All molecular dynamics simulations were carried out using the LAMMPS (Large Atomic and Molecular Massively Parallel Simulator) package.\cite{LAMMPS}
Additional processing was carried out using Numpy.\cite{NumPy}
All graphical figures were plotted using Matplotlib.\cite{MatPlotLib}

